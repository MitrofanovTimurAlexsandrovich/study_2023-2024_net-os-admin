---
## Author
author:
  name: Митрофанов Тимур Александрович
  degrees: DSc
  orcid: 0000-0002-0877-7063
  email: 1132231842@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6

## Title
title: "Лабораторная работа № 15"
subtitle: "Настройка сетевого журналирования"
license: "CC BY"
---

# Цель работы

Получение навыков по работе с журналами системных событий.

# Задание

1. Настройте сервер сетевого журналирования событий.
2. Настройте клиент для передачи системных сообщений в сетевой журнал на сервере.
3. Просмотрите журналы системных событий с помощью нескольких программ. При наличии сообщений о некорректной работе сервисов исправьте ошибки в настройках соответствующих служб.
4. Напишите скрипты для Vagrant, фиксирующие действия по установке и настройке сетевого сервера журналирования.



# Выполнение лабораторной работы

На сервере создайте файл конфигурации сетевого хранения журналов. В файле конфигурации /etc/rsyslog.d/netlog-server.conf включите приём записей журнала по TCP-порту 514. Перезапустите службу rsyslog и посмотрите, какие порты, связанные с rsyslog,
прослушиваются.([рис. @fig-001])

![Настройка сервера сетевого журнала](image/1.png){#fig-001 width=70%}

На сервере настройте межсетевой экран для приёма сообщений по TCP-порту 514  ([рис. @fig-002])

![Настройка межсетевого экрана](image/2.png){#fig-002 width=70%}

На клиенте создайте файл конфигурации сетевого хранения журналов. На клиенте в файле конфигурации /etc/rsyslog.d/netlog-client.conf включите
перенаправление сообщений журнала на 514 TCP-порт сервера. Перезапустите службу rsyslog.  ([рис. @fig-003])

![настройка клиента](image/3.png){#fig-003 width=70%}

На сервере просмотрите один из файлов журнала. ([рис. @fig-004]).

![Просмотр журнала](image/4.png){#fig-004 width=70%}

ЗНа сервере под пользователем user (вместо user укажите свой логин) запустите графическую программу для просмотра журналов ([рис. @fig-005]).

![Графическое окружение](image/5.png){#fig-005 width=70%}

На сервере установите просмотрщик журналов системных сообщений lnav или его аналог. Просмотрите логи с помощью lnav или его аналога([рис. @fig-006]).

![lnav](image/6.png){#fig-006 width=70%}

На виртуальной машине server перейдите в каталог для внесения изменений
в настройки внутреннего окружения /vagrant/provision/server/, создайте в нём каталог netlog, в который поместите в соответствующие подкаталоги конфигурационные файлы

В каталоге /vagrant/provision/server создайте исполняемый файл netlog.sh

Открыв его на редактирование, пропишите в нём следующий скрипт ([рис. @fig-007]).

![Настройка запуска службы на сервере](image/7.png){#fig-007 width=70%}

На виртуальной машине client перейдите в каталог для внесения изменений в настройки внутреннего окружения /vagrant/provision/client/, создайте в нём каталог nentlog, в который поместите в соответствующие подкаталоги конфигурационные файлы

В каталоге /vagrant/provision/client создайте исполняемый файл netlog.sh

Открыв его на редактирование, пропишите в нём следующий скрипт([рис. @fig-008]).

![Настройка запуска службы на клиенте](image/8.png){#fig-008 width=70%}

Для отработки созданных скриптов во время загрузки виртуальных машин server ([рис. @fig-009]) и client ([рис. @fig-010]) в конфигурационном файле Vagrantfile необходимо добавить в соответствующих разделах конфигураций для сервера и клиента

![Вагрант для сервера](image/9.png){#fig-009 width=70%}

![Вагрант для клиента](image/10.png){#fig-010 width=70%}

# Выводы

Сегодня я получил навыки по работе с журналами системных событий.

# Список литературы{.unnumbered}

::: {#refs}
:::
